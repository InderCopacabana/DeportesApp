<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDER Copacabana - Plataforma de Gesti√≥n Deportiva</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="estilos.css">
</head>

<body>
    <!-- Encabezado con navegaci√≥n -->
    <header>
        <div class="container header-content">
            <div class="logo">INDER Copacabana</div>
            <nav>
                <ul>
                    <li class="dropdown">
                        <a href="index.html">Inicio</a>
                    </li>

                    <li class="dropdown">
                        <a href="deportes.html" class="dropdown-toggle">Deportes Formativo<span
                                class="arrow">‚ñº</span></a>
                        <div class="dropdown-content">
                            <a href="deportes.html#futbol">F√∫tbol</a>
                            <a href="deportes.html#futbol_de_salon">F√∫tbol de Sal√≥n</a>
                            <a href="deportes.html#futbol_sala">F√∫tbol sala</a>
                            <a href="deportes.html#ajedrez">Ajedrez</a>
                            <a href="deportes.html#baloncesto">Baloncesto</a>
                            <a href="deportes.html#balonmano">Balonmano</a>
                            <a href="deportes.html#natacion">Nataci√≥n</a>
                            <a href="deportes.html#atletismo">Atletismo</a>
                            <a href="deportes.html#patinaje">Patinaje</a>
                            <a href="deportes.html#rugby">Rugby</a>
                            <a href="deportes.html#tenis">Tenis de campo</a>
                            <a href="deportes.html#voleibol">Voleibol</a>
                            <a href="deportes.html#tenis">Tenis de Mesa</a>
                            <a href="deportes.html">BMX</a>
                            <a href="deportes.html#boxeo">Boxeo</a>
                            <a href="deportes.html#gimnasia">Gimnasia</a>
                            <a href="deportes.html#jiu_jitsu">Jiu Jitsu</a>
                            <a href="deportes.html#levantamiento_de_pesas">Levantamiento de Pesas</a>
                            <a href="deportes.html#taekwondo">Taekwondo</a>
                        </div>
                    </li>

                    <li class="dropdown">
                        <a href="actividades.html" class="dropdown-toggle">Actividades F√≠sicas <span
                                class="arrow">‚ñº</span></a>

                        <div class="dropdown-content">
                            <a href="actividades.html#gimnasio_municipal">Gimnasio Municipal</a>
                            <a href="actividades.html#descubre_tu_talento">Descubre tu Talento</a>
                            <a href="actividades.html#nadadores_activos">Nadadores Activos</a>
                            <a href="actividades.html#yoga">Yoga</a>
                        </div>
                    </li>

                    <li class="dropdown">
                        <a href="recreacion.html" class="dropdown-toggle">Recreaci√≥n<span class="arrow">‚ñº</span></a>

                        <div class="dropdown-content">
                            <a href="recreacion.html#rumba_aerobica">Rumba Aer√≥bica</a>
                            <a href="recreacion.html#hidroaerobicos">Hidroaerobicos</a>

                        </div>
                    </li>

                    <li class="dropdown">
                        <a href="eventos_institucionales.html" class="dropdown-toggle">Eventos Institucionales<span
                                class="arrow">‚ñº</span></a>

                        <div class="dropdown-content">
                            <a href="eventos_institucionales.html#vacaciones_recreativas">Vacaciones Recreativas</a>
                            <a href="eventos_institucionales.html#celebracion_deporte_cultura">Celebraci√≥n del Deporte y
                                Cultura</a>

                        </div>
                    </li>

                    <li class="dropdown">
                        <a href="torneos_festivales.html" class="dropdown-toggle">Torneos y Festivales
                            Institucionales<span class="arrow">‚ñº</span></a>

                        <div class="dropdown-content">
                            <a href="torneos_festivales.html#master">Master</a>
                            <a href="torneos_festivales.html#open">Open</a>
                            <a href="torneos_festivales.html#gran_master">Gran Master</a>
                            <a href="torneos_festivales.html#libre">Libre</a>
                            <a href="torneos_festivales.html#prebenjamines">Prebenjamines</a>
                            <a href="torneos_festivales.html#benjamines">Benjamines</a>
                            <a href="torneos_festivales.html#baby">Baby</a>
                            <a href="torneos_festivales.html#babyfutbol">BabyF√∫tbol</a>
                        </div>
                    </li>

                    <li class="dropdown">
                        <a href="juegos_institucionales.html" class="dropdown-toggle">Juegos Institucionales<span
                                class="arrow">‚ñº</span></a>

                        <div class="dropdown-content">
                            <a href="juegos_institucionales.html#escolares_subregional">Escolares Sub_Regional</a>
                            <a href="juegos_institucionales.html#escolares_departamental">Escolares Departamental</a>
                            <a href="juegos_institucionales.html#intercolegiados_municipal">Intercolegiados
                                Municipal</a>
                            <a href="juegos_institucionales.html#intercolegiados_subregional">Intercolegiados
                                Sub_Regional</a>
                            <a href="juegos_institucionales.html#intercolegiados_departamental">Intercolegiados
                                Departamental</a>
                            <a href="juegos_institucionales.html#mayores_subregional">Mayores sub_regional</a>
                            <a href="juegos_institucionales.html#mayores_departamental">Mayores Departamental</a>
                        </div>
                    </li>

                    <li><a href="diagrama.html">Estad√≠sticas</a></li>
                </ul>
            </nav>
            <!-- Navegaci√≥n din√°mica basada en autenticaci√≥n -->
            <div id="auth-navigation">
                <a href="inicio_de_sesion.html" class="btn btn-secondary" id="login-btn">Iniciar Sesi√≥n</a>
                <div id="user-menu" style="display: none;">
                    <span id="user-name-header">Usuario</span>
                    <a href="Dashboard.html" class="btn btn-primary" id="dashboard-btn">Dashboard</a>
                    <button id="logout-btn" class="btn btn-secondary">Cerrar Sesi√≥n</button>

                </div>
                <button id="menu-toggle" class="menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
    </header>

    <!-- Contenido principal -->
    <main>
        <div class="page-header">
            <div class="container">
                <h1>Torneos y Festivales</h1>
                <p>Lista completa de deportes disponibles con estad√≠sticas de participaci√≥n en tiempo real</p>
                <div style="text-align: center; margin-top: 1rem;">
                    <button onclick="actualizarEstadisticas()" class="btn btn-outline" id="btn-actualizar">
                        üîÑ Actualizar Estad√≠sticas
                    </button>
                    <span id="ultima-actualizacion"
                        style="margin-left: 1rem; color: #6c757d; font-size: 0.9rem;"></span>
                </div>
            </div>
        </div>

        <section class="container">
            <div class="cards-container">            
                <!-- Master -->
                <div id="master" class="card" data-actividad="master">
                    <div class="card-image">
                        <img src="imagenes/balonmano-02.jpg" alt="balonmano">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Master</h3>
                        <p class="card-description">Competencia que re√∫ne experiencia y pasi√≥n en plena edad dorada. Una
oportunidad para mostrar disciplina, talento y camarader√≠a en cada juego.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para cada torneo -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('master')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>


                <!-- Open -->
                <div id="open" class="card" data-actividad="open">
                    <div class="card-image">
                        <img src="imagenes/natacion-02.jpg" alt="open">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Open</h3>
                        <p class="card-description">Categor√≠a abierta para todos, donde la diversidad de estilos y talentos se
encuentran en una misma cancha. Competencia sin l√≠mites de edad, abierta a
todos los que deseen demostrar su amor por el deporte.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Open -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('open')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>

                <!-- Gran Master -->
                <div id="gran_master" class="card" data-actividad="gran_master">
                    <div class="card-image">
                        <img src="imagenes/atletismo-02.jpg" alt="gran_master">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Gran Master</h3>
                        <p class="card-description">M√°s que un torneo, un homenaje a la trayectoria y la pasi√≥n por el deporte en
plena edad oto√±al. Experiencia y disciplina en su m√°xima expresi√≥n</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Gran Master -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('gran_master')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>

                <!-- Libre-->
                <div id="libre" class="card" data-actividad="libre">
                    <div class="card-image">
                        <img src="imagenes/patinaje-02.jpg" alt="libre">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Libre</h3>
                        <p class="card-description">Categor√≠a abierta para todos, donde la diversidad de estilos y talentos se
encuentran en una misma cancha. Competencia sin l√≠mites de edad, abierta a
todos los que deseen demostrar su amor por el deporte.</p>
</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Libre -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('libre')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>

                <!--prebenjamines-->
                <div id="prebenjamines" class="card" data-actividad="prebenjamines">
                    <div class="card-image">
                        <img src="imagenes/rugby-02.jpg" alt="prebenjamines">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Prebenjamines</h3>
                        <p class="card-description">Los m√°s peque√±os empiezan a vivir la magia del deporte. Un espacio para
aprender jugando y dar los primeros pasos en equipo.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Prebenjamines -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('prebenjamines')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>
                <!-- Benjamines -->
                <div id="benjamines" class="card" data-actividad="benjamines">
                    <div class="card-image">
                        <img src="imagenes/tenis-02.jpg" alt="benjamines">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Benjamines</h3>
                        <p class="card-description">Ni√±os que descubren su potencial y se divierten mientras fortalecen disciplina,
coordinaci√≥n y amistad.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Benjamines -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('benjamines')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>


                <!-- Baby -->
                <div id="baby" class="card" data-actividad="baby">
                    <div class="card-image">
                        <img src="imagenes/voleibol-02.jpg" alt="baby">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Baby</h3>
                        <p class="card-description">La iniciaci√≥n perfecta: juegos, diversi√≥n y deporte adaptado para que los ni√±os
empiecen a amar la actividad f√≠sica.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Baby -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('baby')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>

                <!-- BabyF√∫tbol -->
                <div id="baby_futbol" class="card" data-actividad="baby_futbol">
                    <div class="card-image">
                        <img src="imagenes/descubre_tu_talento-02.jpg" alt="baby_futbol">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">Baby F√∫tbol</h3>
                        <p class="card-description">F√∫tbol en su versi√≥n m√°s divertida, encaminando a los equipos y deportistas
para una trayectoria profesional. Una categor√≠a para que los ni√±os aprendan
valores de juego limpio y compa√±erismo desde el inicio.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Participantes:</span>
                                <span class="stat-value" data-stat="total">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Hombres:</span>
                                <span class="stat-value" data-stat="hombres">Cargando...</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Mujeres:</span>
                                <span class="stat-value" data-stat="mujeres">Cargando...</span>
                            </div>
                        </div>
                        <div class="gender-chart">
                            <div class="gender-bar">
                                <div class="gender-segment male" data-chart="male" style="width: 0%;">0%</div>
                                <div class="gender-segment female" data-chart="female" style="width: 0%;">0%</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color male"></div>
                                    <span>Hombres</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color female"></div>
                                    <span>Mujeres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Agregar bot√≥n de inscripci√≥n grupal para Baby F√∫tbol -->
                        <div class="group-registration" style="margin-top: 1rem; text-align: center;">
                            <button onclick="abrirInscripcionGrupal('baby_futbol')" class="btn btn-primary">
                                üë• Inscribir Grupo
                            </button>
                        </div>

                    </div>
                </div>



            </div>
            </div>
            </div>
        </section>
    </main>

    <!-- Pie de p√°gina -->
    <footer>
        <div class="container" style="text-align: center;">
            <p>¬© 2025 INDER Copacabana. Todos los Derechos Reservados.</p>
        </div>
    </footer>

    <!-- Modal de inscripci√≥n grupal para torneos -->
    <div id="modalInscripcionGrupal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
            <span class="close" onclick="cerrarInscripcionGrupal()">&times;</span>
            <h2 id="tituloInscripcionGrupal">üë• Inscripci√≥n Grupal al Torneo</h2>

            <form id="formInscripcionGrupal" onsubmit="agregarParticipante(event)">
                <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="documento_grupal">Documento *</label>
                        <input type="text" id="documento_grupal" name="documento_identidad" required placeholder="CC/TI">
                    </div>

                    <div class="form-group">
                        <label for="nombre_grupal">Nombre Completo *</label>
                        <input type="text" id="nombre_grupal" name="nombre" required placeholder="Nombre completo">
                    </div>

                    <div class="form-group">
                        <label for="edad_grupal">Edad *</label>
                        <input type="number" id="edad_grupal" name="edad" required min="1" max="100">
                    </div>

                    <div class="form-group">
                        <label for="genero_grupal">G√©nero *</label>
                        <select id="genero_grupal" name="genero" required>
                            <option value="">Seleccionar...</option>
                            <option value="Hombre">Hombre</option>
                            <option value="Mujer">Mujer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="barrio_grupal">Barrio *</label>
                        <select id="barrio_grupal" name="barrio" required>
                            <option value="">Barrio/Vereda...</option>
                            <option value="La Veta">La Veta</option>
                            <option value="Zarzal La Luz">Zarzal La Luz</option>
                            <option value="Zarzal Curazao">Zarzal Curazao</option>
                            <option value="Ancon">Ancon</option>
                            <option value="El Noral">El Noral</option>
                            <option value="El Salado">El Salado</option>
                            <option value="Sabaneta">Sabaneta</option>
                            <option value="Quebrada Arriba">Quebrada Arriba</option>
                            <option value="Alvarado">Alvarado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="telefono_grupal">Tel√©fono *</label>
                        <input type="tel" id="telefono_grupal" name="telefono" required placeholder="Ej: 3001234567">
                    </div>

                    <div class="form-group">
                        <label for="correo_grupal">Correo Electr√≥nico *</label>
                        <input type="email" id="correo_grupal" name="correo" required placeholder="correo@ejemplo.com">
                    </div>

                    <div class="form-group">
                        <label for="vereda_grupal">Vereda</label>
                        <select id="vereda_grupal" name="vereda">
                            <option value="">Seleccionar...</option>
                            <option value="Si">S√≠</option>
                            <option value="No">No</option>
                        </select>
                    </div>
                </div>

                <!-- Campos adicionales en una sola fila -->
                <div class="form-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-top: 1rem;">
                    <div class="form-group">
                        <label for="lgbtq_grupal">LGBTQ+</label>
                        <select id="lgbtq_grupal" name="lgbtq">
                            <option value="No">No</option>
                            <option value="S√≠">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="discapacidad_grupal">Discapacidad</label>
                        <select id="discapacidad_grupal" name="discapacidad">
                            <option value="No">No</option>
                            <option value="S√≠">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="victima_grupal">V√≠ctima</label>
                        <select id="victima_grupal" name="victima">
                            <option value="No">No</option>
                            <option value="S√≠">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="madre_cabeza_grupal">Madre Cabeza Hogar</label>
                        <select id="madre_cabeza_grupal" name="madre_cabeza">
                            <option value="No">No</option>
                            <option value="S√≠">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="desplazado_grupal">Desplazado</label>
                        <select id="desplazado_grupal" name="desplazado">
                            <option value="No">No</option>
                            <option value="S√≠">S√≠</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions" style="margin-top: 2rem; text-align: center;">
                    <button type="submit" class="btn btn-primary" id="btnAgregarParticipante">
                        ‚ûï Agregar Participante
                    </button>
                </div>
            </form>

            <!-- Lista de participantes agregados -->
            <div id="listaParticipantes" style="margin-top: 2rem;">
                <h3>üë• Participantes Agregados (<span id="contadorParticipantes">0</span>)</h3>
                <div id="participantesContainer" style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px; padding: 1rem; background-color: #f9f9f9;">
                    <p id="sinParticipantes" style="text-align: center; color: #666; margin: 0;">No hay participantes agregados a√∫n</p>
                </div>
            </div>

            <!-- Botones finales -->
            <div class="form-actions" style="margin-top: 2rem; text-align: center; gap: 1rem; display: flex; justify-content: center;">
                <button type="button" onclick="cerrarInscripcionGrupal()" class="btn btn-secondary">
                    Cancelar
                </button>
                <button type="button" onclick="guardarGrupoCompleto()" class="btn btn-success" id="btnGuardarGrupo" disabled>
                    üíæ Guardar Grupo Completo
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        import {
            supabaseClient,
            isAuthenticated,
            getUserProfile,
            signOut
        } from './supabase-config.js';

        // --- Navegaci√≥n: verificar sesi√≥n e info de usuario ---
        async function updateNavigation() {
            try {
                const isAuth = await isAuthenticated();
                const loginBtn = document.getElementById('login-btn');
                const userMenu = document.getElementById('user-menu');
                const userNameHeader = document.getElementById('user-name-header');

                if (isAuth) {
                    const userProfile = await getUserProfile();
                    if (userProfile) {
                        loginBtn.style.display = 'none';
                        userMenu.style.display = 'flex';
                        userMenu.style.alignItems = 'center';
                        userMenu.style.gap = '1rem';
                        userNameHeader.textContent = userProfile.full_name || userProfile.username || 'Usuario';

                        document.getElementById('logout-btn').addEventListener('click', async () => {
                            try {
                                await signOut();
                                window.location.reload();
                            } catch (error) {
                                console.error('Error al cerrar sesi√≥n:', error);
                            }
                        });
                    }
                } else {
                    loginBtn.style.display = 'inline-block';
                    userMenu.style.display = 'none';
                }
            } catch (error) {
                console.error('Error al actualizar navegaci√≥n:', error);
            }
        }

        // --- Obtener estad√≠sticas generales por actividad ---
        async function obtenerEstadisticasActividades() {
            try {
                const { data, error } = await supabaseClient
                    .from('participantes')
                    .select('actividad, genero');

                if (error) throw error;

                const estadisticas = {};
                data.forEach(({ actividad, genero }) => {
                    if (!estadisticas[actividad]) {
                        estadisticas[actividad] = { total: 0, hombres: 0, mujeres: 0 };
                    }

                    estadisticas[actividad].total++;
                    if (genero === 'Hombre') estadisticas[actividad].hombres++;
                    if (genero === 'Mujer') estadisticas[actividad].mujeres++;
                });

                return estadisticas;
            } catch (error) {
                console.error('Error al obtener estad√≠sticas:', error);
                return {};
            }
        }

        // --- Actualizar tarjeta individual ---
        function actualizarTarjeta(actividad, stats) {
            const tarjeta = document.querySelector(`[data-actividad="${actividad}"]`);
            if (!tarjeta) return;

            const { total = 0, hombres = 0, mujeres = 0 } = stats;
            const porcentajeHombres = total > 0 ? Math.round((hombres / total) * 100) : 0;
            const porcentajeMujeres = total > 0 ? Math.round((mujeres / total) * 100) : 0;

            tarjeta.querySelector('[data-stat="total"]').textContent = total;
            tarjeta.querySelector('[data-stat="hombres"]').textContent = `${hombres} (${porcentajeHombres}%)`;
            tarjeta.querySelector('[data-stat="mujeres"]').textContent = `${mujeres} (${porcentajeMujeres}%)`;

            const barraHombres = tarjeta.querySelector('[data-chart="male"]');
            const barraMujeres = tarjeta.querySelector('[data-chart="female"]');

            barraHombres.style.width = `${porcentajeHombres}%`;
            barraMujeres.style.width = `${porcentajeMujeres}%`;

            barraHombres.textContent = `${porcentajeHombres}%`;
            barraMujeres.textContent = `${porcentajeMujeres}%`;

            setTimeout(() => {
                barraHombres.style.transition = 'width 0.8s ease-in-out';
                barraMujeres.style.transition = 'width 0.8s ease-in-out';
            }, 100);
        }

        // --- Actualizar todas las estad√≠sticas ---
        async function actualizarEstadisticas() {
            const boton = document.getElementById('btn-actualizar');
            const ultimaActualizacion = document.getElementById('ultima-actualizacion');

            boton.textContent = 'üîÑ Actualizando...';
            boton.disabled = true;

            try {
                const estadisticas = await obtenerEstadisticasActividades();

                const actividades = [
                    'master', 'open',
                    'gran_master', 'libre',
                    'prebenjamines', 'benjamines',
                    'baby', 'baby_futbol'
                ];

                actividades.forEach(actividad => {
                    const stats = estadisticas[actividad] || { total: 0, hombres: 0, mujeres: 0 };
                    actualizarTarjeta(actividad, stats);
                });

                const ahora = new Date().toLocaleString('es-ES', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                ultimaActualizacion.textContent = `√öltima actualizaci√≥n: ${ahora}`;

                console.log('Estad√≠sticas actualizadas');
            } catch (error) {
                ultimaActualizacion.textContent = 'Error al actualizar estad√≠sticas';
                console.error('Error al actualizar estad√≠sticas:', error);
            } finally {
                boton.textContent = 'üîÑ Actualizar Estad√≠sticas';
                boton.disabled = false;
            }
        }

        // --- Actualizaci√≥n autom√°tica cada 30 segundos ---
        function iniciarActualizacionAutomatica() {
            setInterval(actualizarEstadisticas, 30000);
        }

        // --- Listeners globales ---
        document.addEventListener('DOMContentLoaded', async () => {
            await updateNavigation();
            await actualizarEstadisticas();
            iniciarActualizacionAutomatica();
        });

        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) actualizarEstadisticas();
        });

        // Exponer funci√≥n al bot√≥n
        window.actualizarEstadisticas = actualizarEstadisticas;

        let actividadGrupalSeleccionada = '';
        let participantesGrupo = [];

        window.abrirInscripcionGrupal = function(actividad) {
            actividadGrupalSeleccionada = actividad;
            participantesGrupo = [];
            
            const modal = document.getElementById('modalInscripcionGrupal');
            const titulo = document.getElementById('tituloInscripcionGrupal');
            
            const titulos = {
                'master': 'üë• Inscripci√≥n Grupal - Master',
                'open': 'üë• Inscripci√≥n Grupal - Open', 
                'gran_master': 'üë• Inscripci√≥n Grupal - Gran Master',
                'libre': 'üë• Inscripci√≥n Grupal - Libre',
                'prebenjamines': 'üë• Inscripci√≥n Grupal - Prebenjamines',
                'benjamines': 'üë• Inscripci√≥n Grupal - Benjamines',
                'baby': 'üë• Inscripci√≥n Grupal - Baby',
                'baby_futbol': 'üë• Inscripci√≥n Grupal - Baby F√∫tbol'
            };
            
            titulo.textContent = titulos[actividad] || 'üë• Inscripci√≥n Grupal al Torneo';
            modal.style.display = 'block';
            
            // Limpiar formulario y lista
            document.getElementById('formInscripcionGrupal').reset();
            actualizarListaParticipantes();
        }

        window.cerrarInscripcionGrupal = function() {
            document.getElementById('modalInscripcionGrupal').style.display = 'none';
            actividadGrupalSeleccionada = '';
            participantesGrupo = [];
        }

        window.agregarParticipante = function(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const participante = {
                documento_identidad: formData.get('documento_identidad'),
                nombre: formData.get('nombre'),
                edad: parseInt(formData.get('edad')),
                genero: formData.get('genero'),
                actividad: actividadGrupalSeleccionada,
                tipo_actividad: 'Torneos y Festivales',
                telefono: formData.get('telefono'),
                correo: formData.get('correo'),
                barrio: formData.get('barrio'),
                vereda: formData.get('vereda') || 'No',
                lgbtq: formData.get('lgbtq') || 'No',
                discapacidad: formData.get('discapacidad') || 'No',
                victima: formData.get('victima') || 'No',
                madrecabezahogar: formData.get('madre_cabeza') || 'No',
                desplazado: formData.get('desplazado') || 'No',
                fecha_registro: new Date().toISOString()
            };
            
            // Verificar si el documento ya existe en el grupo
            if (participantesGrupo.some(p => p.documento_identidad === participante.documento_identidad)) {
                alert('Este documento ya est√° registrado en el grupo');
                return;
            }
            
            participantesGrupo.push(participante);
            document.getElementById('formInscripcionGrupal').reset();
            actualizarListaParticipantes();
            
            // Mostrar mensaje de confirmaci√≥n
            const btnAgregar = document.getElementById('btnAgregarParticipante');
            const textoOriginal = btnAgregar.textContent;
            btnAgregar.textContent = '‚úÖ Agregado!';
            btnAgregar.style.backgroundColor = '#28a745';
            
            setTimeout(() => {
                btnAgregar.textContent = textoOriginal;
                btnAgregar.style.backgroundColor = '';
            }, 1500);
        }

        function actualizarListaParticipantes() {
            const container = document.getElementById('participantesContainer');
            const contador = document.getElementById('contadorParticipantes');
            const btnGuardar = document.getElementById('btnGuardarGrupo');
            
            contador.textContent = participantesGrupo.length;
            
            if (participantesGrupo.length === 0) {
                btnGuardar.disabled = true;
                container.innerHTML = '<p id="sinParticipantes" style="text-align: center; color: #666; margin: 0;">No hay participantes agregados a√∫n</p>';
            } else {
                btnGuardar.disabled = false;
                
                container.innerHTML = participantesGrupo.map((p, index) => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; border-bottom: 1px solid #eee; background: white; margin-bottom: 0.5rem; border-radius: 4px;">
                        <div>
                            <strong>${p.nombre}</strong> - ${p.documento_identidad} 
                            <span style="color: #666;">(${p.genero}, ${p.edad} a√±os)</span>
                        </div>
                        <button onclick="eliminarParticipante(${index})" class="btn btn-sm" style="background: #dc3545; color: white; padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                            üóëÔ∏è Eliminar
                        </button>
                    </div>
                `).join('');
            }
        }

        window.eliminarParticipante = function(index) {
            if (confirm('¬øEst√°s seguro de eliminar este participante?')) {
                participantesGrupo.splice(index, 1);
                actualizarListaParticipantes();
            }
        }

        window.guardarGrupoCompleto = async function() {
            if (participantesGrupo.length === 0) {
                alert('Debes agregar al menos un participante');
                return;
            }
            
            const btnGuardar = document.getElementById('btnGuardarGrupo');
            btnGuardar.textContent = '‚è≥ Guardando...';
            btnGuardar.disabled = true;
            
            try {
                const { data, error } = await supabaseClient
                    .from('participantes')
                    .insert(participantesGrupo);
                
                if (error) throw error;
                
                alert(`¬°Inscripci√≥n grupal exitosa! Se han registrado ${participantesGrupo.length} participantes al torneo.`);
                cerrarInscripcionGrupal();
                
                // Actualizar estad√≠sticas
                setTimeout(() => {
                    actualizarEstadisticas();
                }, 1000);
                
            } catch (error) {
                console.error('Error al guardar grupo:', error);
                alert('Error al procesar la inscripci√≥n grupal. Por favor, intenta nuevamente.');
            } finally {
                btnGuardar.textContent = 'üíæ Guardar Grupo Completo';
                btnGuardar.disabled = false;
            }
        }

        // Cerrar modal con Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                cerrarInscripcionGrupal();
            }
        });

        // Cerrar modal al hacer click fuera
        document.getElementById('modalInscripcionGrupal').addEventListener('click', function(e) {
            if (e.target === this) {
                cerrarInscripcionGrupal();
            }
        });

        // Manejar dropdowns en m√≥vil
        function setupMobileDropdowns() {
            const dropdowns = document.querySelectorAll('.dropdown');

            dropdowns.forEach(dropdown => {
                const toggle = dropdown.querySelector('.dropdown-toggle');
                if (toggle) {
                    toggle.addEventListener('click', function (e) {
                        // Solo en m√≥vil (ancho menor a 768px)
                        if (window.innerWidth <= 768) {
                            e.preventDefault();
                            e.stopPropagation();

                            // Cerrar otros dropdowns
                            dropdowns.forEach(otherDropdown => {
                                if (otherDropdown !== dropdown) {
                                    otherDropdown.classList.remove('active');
                                }
                            });

                            // Toggle el dropdown actual
                            dropdown.classList.toggle('active');
                        }
                    });
                }
            });

            // Cerrar dropdowns al hacer click fuera
            document.addEventListener('click', function (e) {
                if (window.innerWidth <= 768) {
                    if (!e.target.closest('.dropdown')) {
                        dropdowns.forEach(dropdown => {
                            dropdown.classList.remove('active');
                        });
                    }
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', setupMobileDropdowns);
    </script>


</body>

</html>
